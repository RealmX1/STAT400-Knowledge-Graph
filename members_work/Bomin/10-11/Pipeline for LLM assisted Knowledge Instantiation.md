## KG generation from textbook

To list all existing node in a neo4j DB as `node_type:node_name` pairs:
```cypher
MATCH (n)
WITH labels(n) AS node_type, coalesce(n.name, 'Unnamed') AS node_name
RETURN head(node_type) + ':' + node_name AS node_info
```

Goal: progressively instantiate the neo4j knowledge graph according to latex textbook, using markdown schema for nodes as intermediate step.

For Each Chapter,
1. (after first chapter)Give LLM complete content of the chapter, and list of existing `node_type:node_name` pairs in the graph, ask it to find all relations between existing nodes that are mentioned in the content of the chapter, and generate a list of relation_name:relation_type pairs.
   1. Manually add relations.
2. Give LLM complete content of the chapter, description of node types, and list of existing `node_type:node_name` pairs in the graph, ask it to generate a list of `node_type:node_name` pairs to add to the graph for that chapter.
   1. Read Textbook and manually inspect the generated nodes in the list, and modify them if necessary.
   2. For each `node_type:node_name` pair in the list, 
      1. Give LLM the content of the chapter (or even whole book), and the schema of respective node type, ask it to generate a markdown formatted node for the given node_name.
      2. Scrutinize the generated node, and modify it if necessary.
      3. Given the markdown, list of existing `node_type:node_name` pairs in the graph, and some examples of successful conversion, ask LLM to convert the generated node to cypher script that add the node to neo4j.
      4. Run the cypher script to add the node to neo4j.
      5. Manually inspect the added node and information in neo4j, and modify the node if necessary.

### LLM refined process:
**For Each Chapter:**
2. **Generate list of new nodes**
   **(LLM)**: "Generate list of new nodes"
   - **Input**: Complete content of the chapter, description of node types (`node_schemas\README.md`), and the list of existing `node_type:node_name` pairs in the graph.
   - **Prompt**: `generate_nodes_list_prompt.md`
   - **Output**: List of new `node_type:node_name` pairs to add to the graph for that chapter.
   
   **(Human)**: "Review and modify the list of new nodes"
   - **Input**: The list of new `node_type:node_name` pairs generated by the LLM.
   - **Output**: Manually reviewed and potentially modified list of new nodes.

**For each `node_type:node_name` pair in the new node list:**
3. **Generate and add a new node to the graph**
   1. **(LLM)**: "Generate markdown node"
      - **Input**: The content of the chapter (or whole book), schema of the respective node type, list of existing `node_type:node_name` pairs in the graph, and the node name.
      - **Prompt**: `context2node-md_prompt.md`
      - **Output**: Markdown-formatted node for the given `node_name`.
      
   2. **(Human)**: "Scrutinize the generated markdown node"
      - **Input**: The markdown-formatted node generated by the LLM.
      - **Output**: Manually scrutinized and modified (if necessary) markdown node.
      
   3. **(LLM)**: "Convert markdown node to Cypher script"
      - **Input**: The markdown node, list of existing `node_type:node_name` pairs in the graph, and examples of successful conversion.
      - **Prompt**: `node-md2cypher_prompt.md`
      - **Output**: Cypher script that adds the node to Neo4j.
       
   4. **(Human)**: "Run the Cypher script in Neo4j to add the node and relations to the graph"
      - **Input**: The Cypher script generated by the LLM.
      - **Output**: Manually executed Cypher script to add the node to Neo4j.
      
   5. **(Human)**: "Inspect and modify the added node in Neo4j"
      - **Input**: The newly added node and relations in Neo4j.
      - **Output**: Manually inspected and modified node, if necessary, to ensure it is correctly added.




## Adding new knowledge from snippet of exercises/application examples/discussion.
TODO.